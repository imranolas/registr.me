= form_for @klass, url: wizard_path do |f|
  - if @klass.errors.any?
    #error_explanation
      %h2= "#{pluralize(@klass.errors.count, "error")} prohibited this class from being saved:"
      %ul
        - @klass.errors.full_messages.each do |msg|
          %li= msg
  = f.hidden_field :id
  = f.fields_for :lessons do |ff|
    = render 'lesson_fields', f: ff
  = link_to_add_fields "Add Lesson", f, :lessons
  = f.submit 'Save', class: 'btn btn-primary btn-large'

:coffeescript
  $ ->
    $('form').on 'click', '.remove_fields', (event) ->
      $(this).prev('input[type=hidden]').val('1')
      $(this).closest('.field').remove();
      event.preventDefault()

    $('form').on 'click', '.add_fields', (event) ->
      time = new Date().getTime()
      regexp = new RegExp($(this).data('id'), 'g')
      $(this).before($(this).data('fields').replace(regexp, time))
      $('.datetimepicker').datetimepicker({
        language: 'pt-BR'
      })
      event.preventDefault()

    $('.datetimepicker').datetimepicker({
      language: 'pt-BR'
    })
